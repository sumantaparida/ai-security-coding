<div class="motor-details-container">
    <form [formGroup]="offlinePurchaseForm">
        <div flex fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutGap="10px">
            <div fxFlex="90" class="motor-details-header">
                <div fxLayout="row" fxLayout.xs="column" class="heading-row" fxLayout.sm="column" fxLayoutGap="10px">
                    <div class="heading-text">
                        <span *ngIf="productType=='Health'">{{'quote.HEALTH_HOSPITALISATION_CAPS' | translate}}</span>
                        <span *ngIf="productType=='Motor'">{{'quote.MOTOR_INSURANCE_CAPS' | translate}}</span>
                    </div>
                </div>
                <ng-container>
                    <div fxLayout="row" fxLayout.xs="column" class="help-description" fxLayout.sm="column"
                        fxLayoutGap="10px">
                        <!-- Policy Description column  -->
                        <div fxFlex="25" class="policy-description">
                            <img class="motor-details-img" src="{{insurerLogo}}" alt="{{productName}}">
                        </div>
                        <div fxFlex="75">
                            <div class="width-100 product-name margin-35">
                                <label *ngIf="productType=='Motor'">{{productName}} {{vehicleName}}</label>
                                <label *ngIf="productType=='Health'">{{productName}}</label>
                            </div>
                            <div class="width-100 margin-15">
                                <div class="width-20">
                                    <label *ngIf="productType=='Health'">Sum Insured</label>
                                    <label *ngIf="productType=='Motor'">Insured Declared Value</label>
                                </div>

                                <mat-form-field appearance="fill" class="width-25" *ngIf="productType=='Motor'">
                                    <input matInput #input readonly placeholder="Rs. {{insuredValue}}">
                                </mat-form-field>
                                <div class="width-20 text-center"><label>Premium</label></div>
                                <mat-form-field appearance="fill" class="width-25" *ngIf="productType=='Motor'">
                                    <input matInput #input readonly placeholder="Rs. {{premiumAmount}}">
                                </mat-form-field>

                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>
        <div *ngIf="showForms" class="padding">
            <div class="form-container">
                <h2>
                    <mat-icon>account_box</mat-icon><span>Customer Details</span>
                </h2>
                <div class="form-fields">
                    <div class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Type of Customer</mat-label>
                            <mat-select disabled formControlName="customerType" matInput>
                                <mat-option value="INDV">{{'quote.INDIVIDUAL' | translate}}</mat-option>
                                <mat-option value="BUSI">Business</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div class="row required-field" *ngIf="customerType=='INDV'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">First Name<span class="man-field">*</span></mat-label>
                            <input matInput class="form-control minimal" id="firstName" formControlName="firstName">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'firstName'}">
                        </ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='INDV'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Last Name<span class="man-field">*</span></mat-label>
                            <input matInput class="form-control minimal" id="lastName" formControlName="lastName">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'lastName'}">
                        </ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='INDV'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">{{'component.DATE_OF_BIRTH'|translate }}<span
                                    class="man-field">*</span></mat-label>
                            <input (dateInput)="inputEvent($event,'dob')" matInput [matDatepicker]="dobpicker"
                                placeholder="Enter DOB*" [min]="MinDate()" [max]="maxAdultDate" readonly
                                formControlName="dob">
                            <mat-datepicker-toggle matSuffix [for]="dobpicker"></mat-datepicker-toggle>
                            <mat-datepicker #dobpicker></mat-datepicker>
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'dob'}"></ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='INDV'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">{{'component.GENDER'|translate }}<span
                                    class="man-field">*</span></mat-label>
                            <mat-select formControlName="gender">
                                <mat-option value="M">{{'component.MALE'|translate }}</mat-option>
                                <mat-option value="F">{{'component.FEMALE'|translate }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'gender'}"></ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='INDV'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">{{'component.MOBILE_NUMBER'|translate }}<span
                                    class="man-field">*</span></mat-label>
                            <input matInput class="form-control minimal" id="mobileNo" formControlName="mobileNo"
                                mask="0000000000">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'mobileNo'}">
                        </ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='INDV'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">{{'component.EMAIL'|translate }}<span
                                    class="man-field">*</span></mat-label>
                            <input matInput class="form-control minimal" id="emailID" formControlName="emailID">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'emailID'}"></ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='BUSI'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Name of Business Entity<span class="man-field">*</span>
                            </mat-label>
                            <input matInput class="form-control minimal" id="businessEntityName"
                                formControlName="businessEntityName">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'businessEntityName'}">
                        </ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='BUSI'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Date of Incorporation<span class="man-field">*</span>
                            </mat-label>
                            <input matInput [matDatepicker]="dobpicker"
                                (dateInput)="inputEvent($event,'dateOfIncorporation')" [min]="MinDate()"
                                [max]="maxTodayDate" readonly formControlName="dateOfIncorporation">
                            <mat-datepicker-toggle matSuffix [for]="dobpicker"></mat-datepicker-toggle>
                            <mat-datepicker #dobpicker></mat-datepicker>
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'dateOfIncorporation'}">
                        </ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='BUSI'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Pan Number<span class="man-field">*</span></mat-label>
                            <input matInput #input formControlName="panNo" class="form-control minimal">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'panNo'}"></ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='BUSI'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">GSTIN Number</mat-label>
                            <input matInput #input formControlName="gstin" class="form-control minimal">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'gstin'}"></ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='BUSI'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Primary Mobile No.<span class="man-field">*</span>
                            </mat-label>
                            <input matInput class="form-control minimal" id="primaryMobile"
                                formControlName="primaryMobile" mask="0000000000">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'primaryMobile'}">
                        </ng-container>
                    </div>
                    <div class="row required-field" *ngIf="customerType=='BUSI'">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Primary Email ID<span class="man-field">*</span>
                            </mat-label>
                            <input matInput class="form-control minimal" id="primaryEmail"
                                formControlName="primaryEmail">
                        </mat-form-field>
                        <ng-container *ngTemplateOutlet="customerErrorTemplate; context:{key:'primaryEmail'}">
                        </ng-container>
                    </div>
                    <div class="row">
                        <span>&nbsp;</span>
                    </div>
                </div>
                <h2 *ngIf="productType=='Health'">
                    <mat-icon>list</mat-icon>Member Details
                </h2>
                <h2 *ngIf="productType=='Motor'">
                    <mat-icon>list</mat-icon>Vehicle Details
                </h2>
                <div class="form-fields">
                    <div *ngIf="productType=='Motor'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Vehicle Type</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{vehicleType}}">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Motor'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Vehicle Details</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{vehicleName}}">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Motor'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">RTO</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{RTO}}">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Motor'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Claim in the Current Year</mat-label>
                            <input matInput class="form-control minimal" *ngIf="claimCurrentYear=='N'" readonly
                                value="No">
                            <input matInput class="form-control minimal" *ngIf="claimCurrentYear=='Y'" readonly
                                value="Yes">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Motor'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Year of Manufacture</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{yearOfManufacture}}">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Motor'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Registration Date</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{correctregiDate}}">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Motor'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Current Policy Expiry Date</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{currentPolicyExpiryDate}}">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Motor'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">NCB% age</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{ncb}}">
                        </mat-form-field>
                    </div>
                    <ng-container *ngIf="productType=='Health' && members?.length>0">
                        <div *ngFor="let item of members" class="row required-field">
                            <mat-form-field appearance="fill">
                                <mat-label class="cus-form-label">{{item.relationship}}</mat-label>
                                <input *ngIf="item.rating=='NS'" matInput class="form-control minimal" readonly
                                    value="{{item.dob}} - Non Smoker">
                                <input *ngIf="item.rating=='S'" matInput class="form-control minimal" readonly
                                    value="{{item.dob}} - Smoker">
                            </mat-form-field>
                        </div>
                    </ng-container>
                    <div *ngIf="productType=='Health'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Pincode</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{pincode}}">
                        </mat-form-field>
                    </div>
                    <div class="row">
                        <span>&nbsp;</span>
                    </div>
                </div>
                <!-- Policy Details-->
                <h2>
                    <mat-icon>description</mat-icon>Policy Details
                </h2>
                <div class="form-fields">
                    <div class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Bank Branch Code</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{branchCode}}">
                        </mat-form-field>
                    </div>
                    <div class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Bank Branch Location</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{branchLocation}}">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Health'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Policy Type</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{policyType}}">
                        </mat-form-field>
                    </div>
                    <div class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">New Policy/Enhance Existing Cover/Renew Existing Policy
                            </mat-label>
                            <input matInput class="form-control minimal" readonly value="{{newPolicy}}">
                        </mat-form-field>
                    </div>
                    <div *ngIf="productType=='Health'" class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Deductible/Existing Cover</mat-label>
                            <input matInput class="form-control minimal" readonly value="Rs. {{deductible}}">
                        </mat-form-field>
                    </div>
                    <div class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Policy Term</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{policyTerm}} Year">
                        </mat-form-field>
                    </div>
                    <div class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Premium Paying Term</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{premiumPayingTerm}} Year">
                        </mat-form-field>
                    </div>
                    <div class="row required-field">
                        <mat-form-field appearance="fill">
                            <mat-label class="cus-form-label">Mode</mat-label>
                            <input matInput class="form-control minimal" readonly value="{{displayMode}}">
                        </mat-form-field>
                    </div>
                    <div class="row">
                        <span>&nbsp;</span>
                    </div>
                </div>
                <ng-container *ngIf="additionalBenefits?.length>0">
                    <h2>
                        <mat-icon>note_add</mat-icon>Additional Covers
                    </h2>
                    <div class="form-fields block">
                        <div *ngFor="let item of additionalBenefits" class="row required-field">
                            <mat-form-field appearance="fill">
                                <!-- <mat-label class="cus-form-label">Additional Benefits Opted</mat-label> -->
                                <input matInput class="form-control minimal" readonly
                                    value="{{item.displayName}} - Rs. {{item.premium[0]['netPremium']}}">
                            </mat-form-field>
                        </div>
                        <div class="row">
                            <span>&nbsp;</span>
                        </div>
                    </div>
                </ng-container>
                <div class="action">
                    <button mat-raised-button type="button" (click)="backBtn('back')" color="warn"
                        class="cancel-btn">{{'component.CANCEL' | translate}}</button>
                    <button *ngIf="showButton" mat-raised-button type="submit" [disabled]="!disableGenerateBtn()"
                        (click)="submitForm()" class="next-btn">{{'component.SAVE' | translate}}</button>
                    <button *ngIf="!showButton" mat-raised-button type="button" (click)="showNextScreen()"
                        class="next-btn">NEXT</button>
                </div>
            </div>
        </div><!-- show only if customer is ready -->
    </form>

    <div *ngIf="showThanks" flex fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutGap="10px">
        <div fxFlex="80" class="thanks-details-header">
            <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" class="thanks-description"
                fxLayout.sm="column" fxLayoutGap="10px">
                <p>
                    Thank you for your Application. Your Application will now be processed by the Insurer
                    after ensuring all requirements are completed.<br />
                    Your Unique ID number is {{offlineProposalData.applicationNo}}.<br />
                    Please quote this number in all correspondence.
                    <br />
                    <br />
                    Your Insurer Representative is:<br />
                    <span class="rm-details">Name: <b>{{offlineProposalData.applicationData.insurerRmName}}</b></span>
                    <span class="rm-details">Contact Details:
                        <b>{{offlineProposalData.applicationData.insurerRmContact}}</b></span>
                </p>

            </div>
            <div *ngIf="qrCodeError" class="qr-code-error">
                <p>There was some error generating QR Code. Please try after sometime.</p>
            </div>
            <div class="close-btn-div">
                <button mat-raised-button class="cancel-btn" (click)="backBtn('close')" color="warn">Close</button>
                <button mat-raised-button class="next-btn" (click)="generateQRCode()">Generate QR Code</button>
            </div>
        </div>
    </div>
</div>

<ng-template #customerErrorTemplate let-key="key">
    <div class="validation-container">
        <ng-container *ngFor="let validation of validationMessages[key]">
            <div *ngIf="offlinePurchaseForm.get(key)?.hasError(validation.type) && (offlinePurchaseForm.get(key)?.dirty || offlinePurchaseForm.get(key)?.touched)"
                class="invalid-feedback">
                {{validation.message}}
            </div>
        </ng-container>
    </div>
</ng-template>